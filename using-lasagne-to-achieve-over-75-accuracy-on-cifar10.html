<!DOCTYPE html>
<html lang="pl">

<head>
            <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">


        <title>Using Lasagne to achieve over 75% accuracy on CIFAR10.</title>

            <link href="http://kele.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="kele.github.io Full Atom Feed" />
            <link href="http://kele.github.io/feeds/cifar.atom.xml" type="application/atom+xml" rel="alternate" title="kele.github.io Categories Atom Feed" />

        <!-- Bootstrap Core CSS -->
        <link href="./theme/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="./theme/css/clean-blog.min.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
            <link href="./theme/css/code_blocks/darkly.css" rel="stylesheet">


        <!-- Custom Fonts -->
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->




        <meta name="tags" contents="neural networks" />
        <meta name="tags" contents="cifar" />


	                <meta property="og:locale" content="pl_PL.utf8">
		<meta property="og:site_name" content="kele.github.io">

	<meta property="og:type" content="article">
	<meta property="article:author" content="">
	<meta property="og:url" content="./using-lasagne-to-achieve-over-75-accuracy-on-cifar10.html">
	<meta property="og:title" content="Using Lasagne to achieve over 75% accuracy on CIFAR10.">
	<meta property="og:description" content="">
	<meta property="og:image" content="./">
	<meta property="article:published_time" content="2016-01-25 00:00:00+01:00">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="./">kele.github.io</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">

                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-image: url('./theme/images/header.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Using Lasagne to achieve over 75% accuracy on CIFAR10.</h1>
                        <span class="meta">Post napisany przez
                                <a href="./author/kele.html">kele</a>
                            - opublikowano pon 25 stycze≈Ñ 2016
                        </span>
                        
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <!-- Post Content -->
    <article>
        <p>This is the first report of my battle with the <a href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR10
classification</a> problem.</p>
<p>I've decided to use <a href="http://lasagne.readthedocs.org/en/latest/">Lasagne</a> which
is a ligthweight library build on top of
<a href="http://deeplearning.net/software/theano/">Theano</a>.</p>
<p>Here's the source code I'll be talking about in this post:
<a href="https://github.com/kele/cifar_recognition/tree/over75">link</a>.</p>
<h1>Overview</h1>
<ul>
<li>I don't do any data augmentation.</li>
<li>This piece of code was intended to get me familiarized with Lasagne.</li>
<li>It achieves slighly over 75% accuracy and I think it's the peak for this
  design of the neural network.</li>
</ul>
<h1>What is in my toolbox?</h1>
<p>My network consists of both dense and convolutional layers. There's a good
reason to use the latter, since they might exploit the nature of our problem
(which is image classification). More on that can be read
<a href="http://colah.github.io/posts/2014-07-Conv-Nets-Modular/">here</a>,
<a href="http://colah.github.io/posts/2014-07-Understanding-Convolutions/">here</a> and
<a href="http://neuralnetworksanddeeplearning.com/chap6.html">here</a>.</p>
<p>The main intution behind convolutional layers is as follows. We want to detect a
<em>local</em> property of an image, i.e. an edge. We don't really care (for now) where
it is, we just want to be sure that it exists. There's no difference in
detecting an edge in the middle of an image or a few pixels to the right.
Because of that, it makes no sense to keep separate parameters (weights and
biases) for different neurons, just because they're looking in some other place
for the same thing.</p>
<p>An additional benefit is the fact that since we're sharing the parameters, there
are less of them to find.</p>
<h1>Architecture</h1>
<p>How does the architecture look like?</p>
<ul>
<li>Input layer</li>
<li>2d Convolutional layer (128 filters of size 5x5, ReLu)</li>
<li>2d MaxPool layer (pool size 2x2)</li>
<li>2d Convolutional layer (128 filters of size 5x5, ReLu)</li>
<li>2d MaxPool layer (pool size 2x2)</li>
<li>Dropout layer (probability = 0.5)</li>
<li>Dense layer (256 neurons, ReLu)</li>
<li>Softmax layer (10 neurons)</li>
</ul>
<h1>Results</h1>
<p>With this architecture I've managed to achieve a little over 75% of accuracy
with around 2 hours of training (on my GT645<strong>M</strong>, which is not a speed demon).</p>
<h1>Roadmap</h1>
<p>So, what can we do now?</p>
<h3>Changing the network architecture</h3>
<p>So far we can see that my network is pretty shallow. Maybe adding more filters
could help? Also, it might be helpful to put a dense ReLu layer between some
convolution layers. I'll have to experiment with these ideas.</p>
<h3>Better learning techniques</h3>
<p>This version of the code doesn't use <strong>weight decay</strong> nor <strong>learning rate</strong>
decay. The only enchancement is the <strong>momentum</strong>. Both of the missing techniques
could be added easily.</p>
<p>These techniques require some additional tuning, so it might be a
little time consuming to find the right parameters. It'd be a good idea to do
that as the last step, after picking a good network architecture.</p>
<h3>Data augmentation</h3>
<p>So far I haven't done anything with the input data at all.</p>
<p>The following simple transformations come to my mind:</p>
<ul>
<li>cropping the image at random</li>
<li>horizontal flip</li>
<li>rescaling</li>
</ul>
    </article>

        <div class="tags">
            <p>tagi: <a href="./tag/neural-networks.html">neural networks</a>, <a href="./tag/cifar.html">cifar</a>, </p>
        </div>

<hr>
<div class="sharing">
</div>
    <hr>
<div id="disqus_thread"></div>
        <div class="comments">
            <h2>Comments !</h2>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'kele-github-io';
                var disqus_identifier = 'using-lasagne-to-achieve-over-75-accuracy-on-cifar10.html';
                var disqus_url = './using-lasagne-to-achieve-over-75-accuracy-on-cifar10.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//kele-github-io.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                    </ul>
<p class="copyright text-muted">
    Blog powered by <a href="http://getpelican.com">Pelican</a>,
    which takes great advantage of <a href="http://python.org">Python</a>.
</p>                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="./theme/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="./theme/js/bootstrap.min.js"></script>

        <!-- Custom Theme JavaScript -->
        <script src="./theme/js/clean-blog.min.js"></script>


    <!-- GitHub ribbon -->
    <a href="https://github.com/kele/cifar_recognition"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"></a> 
<script type="text/javascript">
    var disqus_shortname = 'kele-github-io';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>

</html>